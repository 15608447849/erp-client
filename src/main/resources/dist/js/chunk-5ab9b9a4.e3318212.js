(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ab9b9a4"],{"1ca5":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modifyInfo"},[a("van-nav-bar",{attrs:{title:"修改信息","left-text":"返回","left-arrow":"",fixed:""},on:{"click-left":function(t){return e.$toPage(-1)}}}),a("van-tabs",{attrs:{animated:""},on:{click:e.onClick},model:{value:e.storeDetail.storetype,callback:function(t){e.$set(e.storeDetail,"storetype",t)},expression:"storeDetail.storetype"}},[a("van-tab",{attrs:{title:"医疗机构",name:"0"}},e._l(e.uploadList,function(t,s){return t.isShow?a("div",{key:s,staticClass:"content"},[a("p",{staticClass:"name"},[e._v(e._s(t.name))]),a("div",{staticClass:"left",on:{click:function(t){return e.clickRead(s)}}},[a("img",{directives:[{name:"show",rawName:"v-show",value:!t.url,expression:"!item.url"}],staticClass:"bdImg",attrs:{src:i("1fe8")},on:{click:function(t){return e.reg_img_select(s)}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:t.url,expression:"item.url"}],attrs:{src:t.url},on:{click:function(t){return e.imgChange(s)}}}),a("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.url,expression:"item.url"}],attrs:{name:"delete"},on:{click:function(t){return e.deleteImg(s)}}})],1),a("div",{staticClass:"right"},[a("van-field",{attrs:{disabled:e.disabled,placeholder:"证件号",label:"证件号","label-width":"50px","input-align":"center"},model:{value:t.certificateno,callback:function(i){e.$set(t,"certificateno",i)},expression:"item.certificateno"}}),a("van-field",{class:t.must?"disabled":"disable",attrs:{disabled:t.must,placeholder:e.placeholder(t.atype),label:"委托人","label-width":"50px","input-align":"center"},model:{value:t.pname,callback:function(i){e.$set(t,"pname",i)},expression:"item.pname"}}),a("div",[a("van-field",{staticClass:"input",attrs:{disabled:e.disabled,placeholder:"起始有效期","input-align":"center",clickable:""},on:{click:function(t){return e.selectTime(1,s)}},model:{value:t.validitys,callback:function(i){e.$set(t,"validitys",i)},expression:"item.validitys"}}),e._v("~\n            "),a("van-field",{staticClass:"input",attrs:{disabled:e.disabled,placeholder:"结束有效期","input-align":"center",clickable:""},on:{click:function(t){return e.selectTime(2,s)}},model:{value:t.validitye,callback:function(i){e.$set(t,"validitye",i)},expression:"item.validitye"}})],1)],1)]):e._e()}),0),a("van-tab",{attrs:{title:"药品经营企业",name:"1"}},e._l(e.uploadList,function(t,s){return t.isShow?a("div",{key:s,staticClass:"content"},[a("p",{staticClass:"name"},[e._v(e._s(t.name))]),a("div",{staticClass:"left"},[a("img",{directives:[{name:"show",rawName:"v-show",value:!t.url,expression:"!item.url"}],staticClass:"bdImg",attrs:{src:i("1fe8")},on:{click:function(t){return e.reg_img_select(s)}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:t.url,expression:"item.url"}],attrs:{src:t.url},on:{click:function(t){return e.imgChange(s)}}}),a("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.url,expression:"item.url"}],attrs:{name:"delete"},on:{click:function(t){return e.deleteImg(s)}}})],1),a("div",{staticClass:"right"},[a("van-field",{attrs:{disabled:e.disabled,placeholder:"证件号",label:"证件号","label-width":"50px","input-align":"center"},model:{value:t.certificateno,callback:function(i){e.$set(t,"certificateno",i)},expression:"item.certificateno"}}),a("van-field",{attrs:{disabled:t.must,placeholder:e.placeholder(t.atype),label:"委托人","label-width":"50px","input-align":"center"},model:{value:t.pname,callback:function(i){e.$set(t,"pname",i)},expression:"item.pname"}}),a("div",[a("van-field",{staticClass:"input",attrs:{disabled:e.disabled,placeholder:"起始有效期","input-align":"center",clickable:""},on:{click:function(t){return e.selectTime(1,s)}},model:{value:t.validitys,callback:function(i){e.$set(t,"validitys",i)},expression:"item.validitys"}}),e._v("~\n            "),a("van-field",{staticClass:"input",attrs:{disabled:e.disabled,placeholder:"结束有效期","input-align":"center",clickable:""},on:{click:function(t){return e.selectTime(2,s)}},model:{value:t.validitye,callback:function(i){e.$set(t,"validitye",i)},expression:"item.validitye"}})],1)],1)]):e._e()}),0)],1),a("van-popup",{staticClass:"popup",model:{value:e.imgShow,callback:function(t){e.imgShow=t},expression:"imgShow"}},[a("p",{on:{click:function(t){return e.viewImg(e.uploadIndex)}}},[e._v("\n      "+e._s(e.$t("messages.regist.lookImg"))+"\n    ")]),a("p",{on:{click:function(t){return e.reg_img_select(e.uploadIndex)}}},[e._v("\n      "+e._s(e.$t("messages.regist.changeImg"))+"\n    ")])]),a("van-image-preview",{attrs:{"lazy-load":"",images:e.showImg},model:{value:e.mask,callback:function(t){e.mask=t},expression:"mask"}}),a("van-popup",{attrs:{position:"bottom",overlay:!1},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[a("van-datetime-picker",{attrs:{type:"date","min-date":e.minDate,"max-date":e.maxDate,"visible-item-count":e.count},on:{cancel:e.cancel,confirm:e.confirm},model:{value:e.currentDate,callback:function(t){e.currentDate=t},expression:"currentDate"}})],1),a("van-field",{attrs:{disabled:e.disabled,placeholder:"开户银行",label:"开户银行",maxlength:"20"},on:{blur:e.blurHeight,focus:e.focusHeight},model:{value:e.storeDetail.invoiceVO.bankers,callback:function(t){e.$set(e.storeDetail.invoiceVO,"bankers",t)},expression:"storeDetail.invoiceVO.bankers"}}),a("van-field",{attrs:{type:"tel",disabled:e.disabled,placeholder:"银行账号",label:"银行账号",maxlength:"30"},on:{blur:e.blurHeight,focus:e.focusHeight},model:{value:e.storeDetail.invoiceVO.account,callback:function(t){e.$set(e.storeDetail.invoiceVO,"account",t)},expression:"storeDetail.invoiceVO.account"}}),a("van-field",{attrs:{type:"tel",disabled:e.disabled,placeholder:"注册电话",label:"注册电话",maxlength:"11"},on:{blur:e.blurHeight,focus:e.focusHeight},model:{value:e.storeDetail.invoiceVO.tel,callback:function(t){e.$set(e.storeDetail.invoiceVO,"tel",t)},expression:"storeDetail.invoiceVO.tel"}}),a("van-checkbox",{attrs:{disabled:e.disabled,"checked-color":"#F91E1E"},model:{value:e.isControlSelling,callback:function(t){e.isControlSelling=t},expression:"isControlSelling"}},[e._v("是否签控销协议")]),a("van-checkbox",{attrs:{disabled:e.disabled,"checked-color":"#F91E1E"},model:{value:e.isStoreSelling,callback:function(t){e.isStoreSelling=t},expression:"isStoreSelling"}},[e._v("是否签强控销协议")]),a("van-button",{ref:"button",attrs:{type:"danger",block:"",disabled:e.disabled},on:{click:e.commit}},[e._v("保存")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.overlay,expression:"overlay"}],staticClass:"overlay"},[a("van-loading",{attrs:{type:"spinner",color:"#fff",size:"65px"}})],1)],1)},s=[],n=(i("28a5"),i("a481"),i("55dd"),i("ac6a"),i("bd86")),l=i("b970"),o={data:function(){var e;return e={overlay:!1,mask:!1,showImg:[],imgShow:!1,text:"修改",disabled:!1,show:!1,currentDate:new Date,minDate:0,count:3,current:new Date,maxDate:new Date(2219,0,1)},Object(n["a"])(e,"minDate",new Date(1919,0,1)),Object(n["a"])(e,"nowDate",""),Object(n["a"])(e,"value",""),Object(n["a"])(e,"tag",""),Object(n["a"])(e,"index",""),Object(n["a"])(e,"isControlSelling",!1),Object(n["a"])(e,"isStoreSelling",!1),Object(n["a"])(e,"uploadList",[{aptid:0,compid:0,atype:10,fileList:[],certificateno:"",url:"",name:"营业执照(必填)",validitys:"",validitye:"",message:"请上传营业执照",cstatus:"0",pname:"",isShow:!0,required:!0,must:!0},{aptid:0,compid:0,atype:11,fileList:[],certificateno:"",url:"",name:"药店经营许可证(必填)",validitys:"",validitye:"",message:"请上传药店经营许可证",cstatus:"0",pname:"",isShow:!1,required:!0,must:!0},{aptid:0,compid:0,atype:12,fileList:[],certificateno:"",url:"",name:"GSP认证(必填)",validitys:"",validitye:"",message:"请上传GSP认证",cstatus:"0",pname:"",isShow:!1,required:!0,must:!0},{aptid:0,compid:0,atype:15,fileList:[],certificateno:"",url:"",name:"机构执业许可证(必填)",validitys:"",validitye:"",message:"请上传机构执业许可证",cstatus:"0",pname:"",isShow:!0,required:!0,must:!0},{aptid:0,compid:0,atype:13,fileList:[],certificateno:"",url:"",name:"采购提货人委托书(必填)",validitys:"",validitye:"",message:"请上传采购提货人委托书",cstatus:"0",pname:"",isShow:!0,required:!0,must:!1},{aptid:0,compid:0,atype:14,fileList:[],certificateno:"",url:"",name:"采购提货人身份证(必填)",validitys:"",validitye:"",message:"请上传采购提货人身份证",cstatus:"0",pname:"",isShow:!0,required:!0,must:!1},{aptid:0,compid:0,atype:16,fileList:[],url:"",name:"诊疗科目副本(必填)",certificateno:"",validitys:"",validitye:"",message:"请上传诊疗科目副本",cstatus:"0",pname:"",isShow:!0,required:!0,must:!0},{aptid:0,compid:0,atype:21,fileList:[],certificateno:"",url:"",name:"食品经营许可(选填)",validitys:"",validitye:"",message:"请上传食品经营许可",cstatus:"0",pname:"",isShow:!0,required:!1,must:!0},{aptid:0,compid:0,atype:22,fileList:[],certificateno:"",url:"",name:"二类医疗器械许可(选填)",validitys:"",validitye:"",message:"请上传二类医疗器械许可",cstatus:"0",pname:"",isShow:!0,required:!1,must:!0}]),Object(n["a"])(e,"bankInfo",{}),Object(n["a"])(e,"storeDetail",{cid:0,cname:"",caddrcode:"0",caddr:"",inviter:"0",storetype:0,uphone:"0",cstatus:"0",control:0,invoiceVO:{oid:"0",cid:"0",taxpayer:"",bankers:"",account:"",tel:"",cstatus:"0",email:""},aptitudeVOS:[{aptid:"0",compid:0,atype:"0",certificateno:"0",validitys:"",validitye:"",cstatus:"0",pname:""}],busScopeVOS:[{bscid:"0",compid:0,busscope:"0",codename:"0",cstatus:"0"}],caddrname:"",busScopeStr:""}),Object(n["a"])(e,"compid",0),Object(n["a"])(e,"imgList",[]),e},mounted:function(){this.compid=this.$route.query.compid,this.getCompInfo(),this.fileServerInfo()},methods:{onClickRight:function(){var e=this;this.disabled?l["a"].confirm({title:"温馨提示",message:"修改药店信息后需要重新审核~"}).then(function(){e.text="取消",e.disabled=!1}):(this.text="修改",this.disabled=!0)},onClick:function(e){1==e?(this.uploadList[1].isShow=!0,this.uploadList[2].isShow=!0,this.uploadList[3].isShow=!1,this.uploadList[6].isShow=!1):(this.uploadList[1].isShow=!1,this.uploadList[2].isShow=!1,this.uploadList[3].isShow=!0,this.uploadList[6].isShow=!0),this.storeDetail.storetype=e},beforeRead:function(e){this.uploadList[this.selectImg].url=e.content},clickRead:function(e){this.selectImg=e},selectTime:function(e,t){this.show=!0,this.tag=e,this.index=t},cancel:function(){this.show=!1},confirm:function(){this.show=!1;var e=this.currentDate.getFullYear(),t=this.currentDate.getMonth()+1,i=this.currentDate.getDate();t=t<10?"0"+t:t,i=i<10?"0"+i:i,this.nowDate=e+"-"+t+"-"+i,1==this.tag?this.uploadList[this.index].validitys=this.nowDate:2==this.tag&&(this.uploadList[this.index].validitye=this.nowDate)},commit:function(){this.overlay=!0,this.iQualification(this.uploadList)&&this.updateStoreInfo()},getCompInfo:function(){var e=this;JNB.query({serverName:"userServer",cls:"BackGroundProxyMoudule",method:"getCompInfo",params:{compid:this.compid},callback:function(t){var i=JSON.parse(t);200==i.code&&(e.storeDetail=i.data,1==i.data.control&&(e.isControlSelling=!0),(2&i.data.control)>0&&(e.isStoreSelling=!0,e.isControlSelling=!0),0!==e.storeDetail.storetype&&(e.storeDetail.storetype=1),e.onClick(i.data.storetype),i.data.aptitudeVOS.forEach(function(t){e.uploadList.forEach(function(e){e.atype==t.atype&&(e.aptid=t.aptid,e.compid=t.compid,e.atype=t.atype,e.certificateno=t.certificateno,e.validitys=t.validitys,e.validitye=t.validitye,e.cstatus=t.cstatus,e.pname=t.pname)})}))}})},fileServerInfo:function(){var e=this;JNB.query({serverName:"globalServer",cls:"FileInfoModule",method:"fileServerInfo",params:{compid:this.compid},callback:function(t){var i=JSON.parse(t);if(200==i.code){var a=i.data.ergodicUrl,s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState&&200===s.status){var t=s.responseText;t=JSON.parse(t).data.sort(),e.initImgList(t,i)}},s.open("POST",a,!0),s.setRequestHeader("specify-path",i.data.companyFilePath),s.setRequestHeader("ergodic-sub","false"),s.send(null)}}})},initImgList:function(e,t){for(var i in e)this.uploadList.forEach(function(a){var s=e[i].replace(/[^0-9]/gi,"");s==a.atype&&(a.fileList=[{uid:a.atype,name:e[i],status:"done"}],a.url=t.data.downPrev+t.data.companyFilePath+e[i]+"?"+(new Date).getSeconds())})},updateStoreInfo:function(){var e=this;this.storeDetail.aptitudeVOS=[],this.uploadList.forEach(function(t){var i=!1;e.storeDetail.storetype?15!==t.atype&&16!==t.atype&&(i=!0):11!==t.atype&&12!==t.atype&&(i=!0),i&&(""!==t.certificateno&&""!==t.validitys||""!==t.validitye)&&e.storeDetail.aptitudeVOS.push({aptid:t.aptid,compid:t.compid,atype:t.atype,certificateno:t.certificateno,validitys:t.validitys,validitye:t.validitye,cstatus:t.cstatus,pname:t.pname})}),this.storeDetail.control=this.isStoreSelling?3:this.isControlSelling?1:0,JNB.query({serverName:"userServer",cls:"BackGroundProxyMoudule",method:"storePerfectingInfo",params:this.storeDetail,callback:function(t){var i=JSON.parse(t);200==i.code?e.resetImg():(e.$toast.fail(i.data),e.overlay=!1)}})},resetImg:function(){var e=this;JNB.query({serverName:"globalServer",cls:"FileInfoModule",method:"fileServerInfo",params:{compid:this.compid},callback:function(t){var i=JSON.parse(t);if(200==i.code){var a=[],s=i.data;e.uploadList.forEach(function(e){"image"==e.url.slice(0,5)&&a.push({remotePath:s.companyFilePath,fileName:e.atype+".jpg",uri:e.url})}),a.length>0?JNB._requestNative("fileUpload",JSON.stringify({url:s.upUrl,files:a}),function(t){var i=JSON.parse(t);200===i.code?(e.$toast("修改成功！"),e.overlay=!1,e.getCompInfo()):(e.$toast.fail("证件上传失败！"),e.overlay=!1)}):(e.$toast("修改成功！"),e.overlay=!1,e.getCompInfo())}else e.overlay=!1}})},imgChange:function(e){this.imgShow=!0,this.uploadIndex=e},viewImg:function(e){this.imgShow=!1,this.uploadList[e].url&&(this.showImg[0]=this.uploadList[e].url,this.mask=!0)},reg_img_select:function(e){var t=this;this.imgShow=!1,JNB._requestNative("openImageSelect",function(i){i&&(t.uploadList[e].url=i)})},iQualification:function(e){for(var t=!0,i="证件图片、营业执照信息必填",a=0;a<e.length;a++)e[a].isShow&&e[a].required&&!e[a].url&&(t=!1),10===e[a].atype&&(""!==e[a].certificateno&&""!==e[a].validitys&&null!==e[a].validitys&&""!==e[a].validitye&&null!==e[a].validitye||(t=!1));return!t&&this.$toast.fail(i),t||(this.overlay=!1),t},deleteImg:function(e){var t=this;this.imgList[0]=this.uploadList[e].url,this.imgList[0]=this.imgList[0].split("?")[0],l["a"].confirm({title:"温馨提示",message:"确认删除此证书吗？"}).then(function(){JNB._requestNative("delFiles",JSON.stringify(t.imgList),function(){t.uploadList[e].url=""})}).catch(function(){})},placeholder:function(e){if(13==e||14==e)return"委托人"},focusHeight:function(){this.$refs.button.style.marginBottom="250px",document.body.scrollTop=9999,document.documentElement.scrollTop=9999},blurHeight:function(){this.$refs.button.style.marginBottom=0}}},r=o,c=(i("a8b5"),i("2877")),d=Object(c["a"])(r,a,s,!1,null,"5760a65f",null);t["default"]=d.exports},"2f21":function(e,t,i){"use strict";var a=i("79e5");e.exports=function(e,t){return!!e&&a(function(){t?e.call(null,function(){},1):e.call(null)})}},"4a48":function(e,t,i){},"55dd":function(e,t,i){"use strict";var a=i("5ca1"),s=i("d8e8"),n=i("4bf8"),l=i("79e5"),o=[].sort,r=[1,2,3];a(a.P+a.F*(l(function(){r.sort(void 0)})||!l(function(){r.sort(null)})||!i("2f21")(o)),"Array",{sort:function(e){return void 0===e?o.call(n(this)):o.call(n(this),s(e))}})},a481:function(e,t,i){"use strict";var a=i("cb7c"),s=i("4bf8"),n=i("9def"),l=i("4588"),o=i("0390"),r=i("5f1b"),c=Math.max,d=Math.min,u=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,m=/\$([$&`']|\d\d?)/g,v=function(e){return void 0===e?e:String(e)};i("214f")("replace",2,function(e,t,i,f){return[function(a,s){var n=e(this),l=void 0==a?void 0:a[t];return void 0!==l?l.call(a,n,s):i.call(String(n),a,s)},function(e,t){var s=f(i,e,this,t);if(s.done)return s.value;var u=a(e),p=String(this),m="function"===typeof t;m||(t=String(t));var g=u.global;if(g){var b=u.unicode;u.lastIndex=0}var y=[];while(1){var w=r(u,p);if(null===w)break;if(y.push(w),!g)break;var S=String(w[0]);""===S&&(u.lastIndex=o(p,n(u.lastIndex),b))}for(var k="",x=0,D=0;D<y.length;D++){w=y[D];for(var L=String(w[0]),I=c(d(l(w.index),p.length),0),O=[],C=1;C<w.length;C++)O.push(v(w[C]));var N=w.groups;if(m){var $=[L].concat(O,I,p);void 0!==N&&$.push(N);var _=String(t.apply(void 0,$))}else _=h(L,p,I,O,N,t);I>=x&&(k+=p.slice(x,I)+_,x=I+L.length)}return k+p.slice(x)}];function h(e,t,a,n,l,o){var r=a+e.length,c=n.length,d=m;return void 0!==l&&(l=s(l),d=p),i.call(o,d,function(i,s){var o;switch(s.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(r);case"<":o=l[s.slice(1,-1)];break;default:var d=+s;if(0===d)return i;if(d>c){var p=u(d/10);return 0===p?i:p<=c?void 0===n[p-1]?s.charAt(1):n[p-1]+s.charAt(1):i}o=n[d-1]}return void 0===o?"":o})}})},a8b5:function(e,t,i){"use strict";var a=i("4a48"),s=i.n(a);s.a}}]);
//# sourceMappingURL=chunk-5ab9b9a4.e3318212.js.map