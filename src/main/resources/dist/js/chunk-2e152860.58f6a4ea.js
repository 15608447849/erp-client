(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2e152860"],{"05b5":function(e,a,t){"use strict";t.r(a);var s=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"myInvoice"},[t("van-nav-bar",{attrs:{title:"我的发票"},on:{"click-left":function(a){return e.$toPage(-1)},"click-right":e.editInfo}},[t("van-icon",{attrs:{slot:"left",name:"arrow-left",size:"24px",color:"#666666"},slot:"left"}),t("span",{staticStyle:{"font-size":"15px"},attrs:{slot:"right"},slot:"right"},[e._v(e._s(e.right))])],1),t("van-tabs",{on:{click:e.tabsClick}},[t("van-tab",{attrs:{title:"开票信息"}},[t("van-cell-group",[t("van-field",{attrs:{disabled:"",label:"公司名称",placeholder:"请输入公司名称",size:"large","label-width":"120px",border:!1},model:{value:e.storeName,callback:function(a){e.storeName=a},expression:"storeName"}}),t("van-field",{attrs:{disabled:"",label:"注册地址",placeholder:"请输入药店注册地址",size:"large","label-width":"120px",border:!1},model:{value:e.address,callback:function(a){e.address=a},expression:"address"}}),t("van-field",{attrs:{disabled:"",label:"纳税人识别号",placeholder:"纳税人识别号",size:"large","label-width":"120px",type:"tel",border:!1},model:{value:e.invoiceInfo.taxpayer,callback:function(a){e.$set(e.invoiceInfo,"taxpayer",a)},expression:"invoiceInfo.taxpayer"}}),t("van-field",{attrs:{disabled:e.mask,label:"注册电话",placeholder:"请输入注册电话",maxlength:"11",size:"large","label-width":"120px",type:"tel","error-message":e.message,border:!1},on:{focus:e.focusPhone},model:{value:e.invoiceInfo.tel,callback:function(a){e.$set(e.invoiceInfo,"tel",a)},expression:"invoiceInfo.tel"}}),t("van-field",{attrs:{disabled:e.mask,label:"开户银行",placeholder:"请输入开户银行",maxlength:"20",size:"large","label-width":"120px",border:!1},model:{value:e.invoiceInfo.bankers,callback:function(a){e.$set(e.invoiceInfo,"bankers",a)},expression:"invoiceInfo.bankers"}}),t("van-field",{attrs:{disabled:e.mask,label:"银行账号",placeholder:"请输入银行账号",maxlength:"30",size:"large","label-width":"120px",type:"tel",border:!1,"error-message":e.account},on:{focus:e.focusAccount},model:{value:e.invoiceInfo.account,callback:function(a){e.$set(e.invoiceInfo,"account",a)},expression:"invoiceInfo.account"}})],1)],1),t("van-tab",{attrs:{title:"发票收件邮箱"}},[t("van-cell-group",[t("van-field",{attrs:{label:"电子邮箱",disabled:e.mask,placeholder:"xx@xx.com",size:"large","label-width":"120px"},model:{value:e.email,callback:function(a){e.email=a},expression:"email"}})],1),t("van-cell-group",{directives:[{name:"show",rawName:"v-show",value:!e.mask,expression:"!mask"}]},[t("van-field",{attrs:{center:"",clearable:"",size:"large","label-width":"120px",label:"验证码",placeholder:"请输入邮箱验证码"},model:{value:e.emailCode,callback:function(a){e.emailCode=a},expression:"emailCode"}},[t("van-button",{attrs:{slot:"button",size:"small",type:"primary"},on:{click:e.sendEmail},slot:"button"},[t("span",{directives:[{name:"show",rawName:"v-show",value:!e.time,expression:"!time"}]},[e._v("发送验证码")]),t("span",{directives:[{name:"show",rawName:"v-show",value:e.time,expression:"time"}]},[e._v(e._s(e.time))])])],1)],1)],1)],1),t("van-button",{directives:[{name:"show",rawName:"v-show",value:0==e.tabs,expression:"tabs == 0"}],staticClass:"button",attrs:{type:"danger",size:"large",disabled:e.mask},on:{click:e.btn_myInvoice}},[e._v("\n    保存\n  ")]),t("van-button",{directives:[{name:"show",rawName:"v-show",value:1==e.tabs,expression:"tabs == 1"}],staticClass:"button",attrs:{type:"danger",size:"large",disabled:!e.email||!e.emailCode},on:{click:e.saveEmail}},[e._v("\n    保存\n  ")])],1)},i=[],o={data:function(){return{invoiceInfo:{},storeName:this.$loadUserInfo().comp.storeName,address:this.$loadUserInfo().comp.address,tabs:0,emailCode:"",mask:!0,email:"",time:0,flag:!0,right:"编辑",message:"",account:""}},mounted:function(){this.getInvoiceInfo()},methods:{test:function(){return/^1(3|4|5|6|7|8|9)\d{9}$/.test(this.invoiceInfo.tel)?!(this.invoiceInfo.account.length<9||this.invoiceInfo.account.length>30)||(this.account="银行账号格式错误",!1):(this.message="手机号格式错误",!1)},focusPhone:function(){this.message=""},focusAccount:function(){this.account=""},btn_myInvoice:function(){var e=this;this.test()&&JNB.query({serverName:"userServer",cls:"MyInvoiceModule",method:"saveInvoice",params:{bankers:this.invoiceInfo.bankers,account:this.invoiceInfo.account,tel:this.invoiceInfo.tel},callback:function(a){var t=JSON.parse(a);200==t.code?(e.$toast(t.data),e.right="编辑",e.mask=!0):e.$toast.fail(t.message)}})},getInvoiceInfo:function(){var e=this;JNB.query({serverName:"userServer",cls:"MyInvoiceModule",method:"getInvoice",params:{},callback:function(a){a=JSON.parse(a),200==a.code&&a.data.length>0&&(e.invoiceInfo=a.data[0],e.email=e.invoiceInfo.email)}})},tabsClick:function(e){this.tabs=e,this.mask=!0,this.right="编辑"},sendEmail:function(){var e=this,a=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;if(a.test(this.email)){this.flag=!1,JNB.query({serverName:"userServer",cls:"MyInvoiceModule",method:"applyEmailVaildCode",params:[this.email],callback:function(a){var t=JSON.parse(a);200==t.code?e.$toast(t.data):(e.$toast.fail(t.message),e.flag=!0)}}),this.time=60;var t=setInterval(function(){e.time--,e.time<=0&&(clearInterval(t),e.time="",e.flag=!0)},1e3)}else this.$toast.fail("请输入正确的邮箱号！")},saveEmail:function(){var e=this;JNB.query({serverName:"userServer",cls:"MyInvoiceModule",method:"saveEmail",params:[this.emailCode,this.email],callback:function(a){var t=JSON.parse(a);200==a.code?(e.$toast(t.data),e.$router.go(0)):e.$toast.fail(t.message)}})},editInfo:function(){"编辑"==this.right?(this.mask=!1,this.right="取消"):(this.mask=!0,this.right="编辑")}}},n=o,l=(t("f196"),t("2877")),r=Object(l["a"])(n,s,i,!1,null,"ee895f38",null);a["default"]=r.exports},8010:function(e,a,t){},f196:function(e,a,t){"use strict";var s=t("8010"),i=t.n(s);i.a}}]);
//# sourceMappingURL=chunk-2e152860.58f6a4ea.js.map